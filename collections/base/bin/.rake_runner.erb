#!/usr/bin/env ruby
#!/usr/bin/env ruby
#
# This file was generated by RubyGems.
#
# The application 'rake' is installed as part of a gem, and
# this file is here to facilitate running it.
#

require 'rubygems'

version = ">= 0"

if ARGV.first =~ /^_(.*)_$/ and Gem::Version.correct? $1 then
  version = $1
  ARGV.shift
end

if File.exists?(File.expand_path('../../Gemfile.lock', __FILE__))
  rake_line = `grep -E "rake \\\\([0-9]" Gemfile.lock`.chomp
  if rake_line.length > 0
    rake_line =~ /\((.*)\)/
    $LOAD_PATH.unshift(File.expand_path("vendor/bundle/jruby/<%= ruby_version %>/gems/rake-#{$1}/lib"))
    version = "= #{$1}"
    loaded = true
    require 'rake'

    # Can't use Gem.bin_path below since rake hasn't been loaded as a gem.
    Rake.application.run
  end
end

unless loaded
  gem 'rake', version
  load Gem.bin_path('rake', 'rake', version)
end
